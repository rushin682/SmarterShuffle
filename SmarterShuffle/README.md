Smarter Shuffle.


Will update later.
